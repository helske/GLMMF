{
    "contents" : "grfn<-function(pars,model,estimate=TRUE,env=parent.frame()){      \n  if(ndisp>0){        \n    model$u[]<-matrix(exp(pars[1:ndisp]),n,p,byrow=TRUE)\n  }\n  if(nr>0){\n    if(any(exp(pars[ndisp+1:nr])>1e5)) #mixing with fixed effects\n      return(.Machine$double.xmax)\n    P1<-diag(exp(pars[ndisp+1:nr]))\n    \n    model$P1[(nf+nc+nd+1):m,(nf+nc+nd+1):m]<-\n      as.matrix(.bdiag(replicate(p,P1,simplify=FALSE)))\n  }\n  if(nf>0){\n    Z<-matrix(0,nrow=p,ncol=nf)\n    Z[lower.tri(Z,TRUE)]<-pars[(ndisp+nr+1):length(pars)]\n    model$Z[1:nf,1:p,]<-t(Z)\n  }\n  if(estimate){        \n    if(itertheta)\n      theta <-get(\"prevtheta\",envir=env)\n    \n    res<-expfLogLikNoSim(model$y, model$Z, model$u, model$a1, model$P1, model$P1inf, \n                         dist, model$tol, maxiter, maxiter2, convtol, theta, model$Zind, model$nfactors,trace,1)\n    res$theta[res$theta>5]<-5\n    res$theta[res$theta< -5]<- -5\n    assign(\"prevtheta\",res$theta,envir=env)\n    if(res$conv<0){\n      warning(\"Approximating algorithm did not converge.\")\n      lik<- 0\n    } else {\n      lik <- res$gradient[lower.tri(res$gradient,TRUE)]\n    }\n    -lik\n  }else model\n}",
    "created" : 1414702603188.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "3733450370",
    "id" : "9681FA41",
    "lastKnownWriteTime" : 19984925217456239,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled2"
    },
    "source_on_save" : false,
    "type" : "r_source"
}
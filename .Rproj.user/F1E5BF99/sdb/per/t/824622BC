{
    "contents" : "load(\"../StateSpaceGLMM/borneodata.rda\")\n\ndat = read.csv(\"../StateSpaceGLMM/born.csv\")\nY = dat[,-(1:4)]\nX = dat[,2:4] #remove id column\n#remove rare species:\nY = as.matrix(Y[,apply(Y>0,2,sum)>30])\n\nset.seed(1)\nrandu1<-rnorm(37)\nrandu2<-rnorm(37)\n\nsave(Y,dat,X,file=\"D:/dat.rda\")\n\nfitinit<-glmmf(group=\"species\",response=\"abundance\",distinct=~Logging+Slope+randu1+randu2,\n               nfactors=0,distribution=\"poisson\",\n               data=borneodata,control=list(trace=1,REPORT=1),method=\"BFGS\")\n\nfitinit$log #-3307.467\n\ninitmat<-t(matrix(fitinit$coefs[,28],nrow=3)[2:3,])\n\n\n\nfit<-glmmf(group=\"species\",response=\"abundance\",distinct=~1,nfactors=2,distribution=\"poisson\",\n           data=spiderdata,control=list(trace=1,REPORT=1,maxit=1000),method=\"BFGS\",init.factor=initmat,estimate=TRUE)\n\nfactors<-fit$coefs[1:2,]\nplot(x=factors[1,],y=factors[2,],pch=NA)\ntext(x=factors[1,],y=factors[2,], labels=as.character(1:28))\n\n\n\nmodel<-  buildSSGLMM(Y ~ randu1+randu2,distribution=\"poisson\")\n\nf<-function(maxiter=100,convtol=1e-10){\n  dist<-pmatch(x = model$distribution, \n               table = c(\"gaussian\", \"poisson\", \"binomial\", \n                         \"gamma\", \"negative binomial\"), duplicates.ok = TRUE)\n  theta<-KFAS:::init_theta(model$y, model$u, model$distribution)\n  \n  out<-expfLogLikNoSim(model$y, model$Z, model$u, model$a1, model$P1, model$P1inf, \n                       dist, model$tol,maxiter,convtol,theta)\n  out$logLik+KFAS:::scaling(model$y,model$u,model$distribution,out$theta)\n}\nf() ##-9712.146\nmicrobenchmark(f(),times=1) #13.50376\n\nmodel<-  buildSSGLMM(Y ~ Logging+Slope+randu1+randu2,data=X,distribution=\"poisson\")\ndim(model$a1) #959 tilaa\ndim(model$Z) #7 137  37\n\nf(maxiter=0) \nmicrobenchmark(f(),times=1)\n\n\nmicrobenchmark(expfLogLikNoSim(model$y, model$Z, model$u, model$a1, model$P1, model$P1inf, \n                     dist, model$tol,1,1e-10,theta),times=2)\n\n",
    "created" : 1414143480196.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2715159000",
    "id" : "824622BC",
    "lastKnownWriteTime" : 1414144727,
    "path" : "U:/MyPrograms/gitrepos/GLMMF/bor.R",
    "project_path" : "bor.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}